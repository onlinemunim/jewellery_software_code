<?php /**
 * 
 * @ModificaionHistory
 *  MODIFICATION DATE:
 *  AUTHOR:
 *  REASON:
 * ======================================================================================
 *  THIS CODE IS BUILD FOR ADD THE STOCK ITEMS FROM STOCK TABLE
 *  ======================================================================================
 */
?>
<?php

include 'system/omsachsc.php';
require_once 'system/omsgeagb.php';
require_once 'system/omssopin.php';
//
//
$strTallyXMLStock = '<ENVELOPE>
 <HEADER>
  <TALLYREQUEST>Import Data</TALLYREQUEST>
 </HEADER>
 <BODY>
  <IMPORTDATA>
   <REQUESTDESC>
    <REPORTNAME>All Masters</REPORTNAME>
    <STATICVARIABLES>
     <SVCURRENTCOMPANY>SoftwareGen Services</SVCURRENTCOMPANY>
    </STATICVARIABLES>
   </REQUESTDESC>
   <REQUESTDATA>';
//
$qSelAllStocks = "SELECT * FROM stock";
$resAllStocks = mysqli_query($conn, $qSelAllStocks) or die("Error: " . mysqli_error($conn) . " with query " . $qSelAllStocks);

while ($rowAllStocks = mysqli_fetch_array($resAllStocks, MYSQLI_ASSOC)) {
    $strTallyXMLStock .= "\n".'  <TALLYMESSAGE xmlns:UDF="TallyUDF">
     <STOCKITEM NAME="' . $rowAllStocks['st_item_name'] . '" RESERVEDNAME="">
      <OLDAUDITENTRYIDS.LIST TYPE="Number">
       <OLDAUDITENTRYIDS></OLDAUDITENTRYIDS>
      </OLDAUDITENTRYIDS.LIST>
      <GUID></GUID>
      <PARENT>' . $rowAllStocks['st_product_type'] . '</PARENT>
      <CATEGORY/>
      <GSTAPPLICABLE></GSTAPPLICABLE>
      <TAXCLASSIFICATIONNAME/>
      <GSTTYPEOFSUPPLY>Goods</GSTTYPEOFSUPPLY>
      <EXCISEAPPLICABILITY></EXCISEAPPLICABILITY>
      <SALESTAXCESSAPPLICABLE/>
      <VATAPPLICABLE></VATAPPLICABLE>
      <COSTINGMETHOD></COSTINGMETHOD>
      <VALUATIONMETHOD></VALUATIONMETHOD>
      <BASEUNITS>' . $rowAllStocks['st_gs_weight_type'] . '</BASEUNITS>
      <ADDITIONALUNITS/>
      <EXCISEITEMCLASSIFICATION/>
      <VATBASEUNIT>' . $rowAllStocks['st_gs_weight_type'] . '</VATBASEUNIT>
      <ISCOSTCENTRESON>No</ISCOSTCENTRESON>
      <ISBATCHWISEON>No</ISBATCHWISEON>
      <ISPERISHABLEON>No</ISPERISHABLEON>
      <ISENTRYTAXAPPLICABLE>No</ISENTRYTAXAPPLICABLE>
      <ISCOSTTRACKINGON>No</ISCOSTTRACKINGON>
      <ISUPDATINGTARGETID>No</ISUPDATINGTARGETID>
      <ASORIGINAL>Yes</ASORIGINAL>
      <ISRATEINCLUSIVEVAT>No</ISRATEINCLUSIVEVAT>
      <IGNOREPHYSICALDIFFERENCE>No</IGNOREPHYSICALDIFFERENCE>
      <IGNORENEGATIVESTOCK>No</IGNORENEGATIVESTOCK>
      <TREATSALESASMANUFACTURED>No</TREATSALESASMANUFACTURED>
      <TREATPURCHASESASCONSUMED>No</TREATPURCHASESASCONSUMED>
      <TREATREJECTSASSCRAP>No</TREATREJECTSASSCRAP>
      <HASMFGDATE>No</HASMFGDATE>
      <ALLOWUSEOFEXPIREDITEMS>No</ALLOWUSEOFEXPIREDITEMS>
      <IGNOREBATCHES>No</IGNOREBATCHES>
      <IGNOREGODOWNS>No</IGNOREGODOWNS>
      <CALCONMRP>No</CALCONMRP>
      <EXCLUDEJRNLFORVALUATION>No</EXCLUDEJRNLFORVALUATION>
      <ISMRPINCLOFTAX>No</ISMRPINCLOFTAX>
      <ISADDLTAXEXEMPT>No</ISADDLTAXEXEMPT>
      <ISSUPPLEMENTRYDUTYON>No</ISSUPPLEMENTRYDUTYON>
      <GVATISEXCISEAPPL>No</GVATISEXCISEAPPL>
      <REORDERASHIGHER>No</REORDERASHIGHER>
      <MINORDERASHIGHER>No</MINORDERASHIGHER>
      <ISEXCISECALCULATEONMRP>No</ISEXCISECALCULATEONMRP>
      <INCLUSIVETAX>No</INCLUSIVETAX>
      <GSTCALCSLABONMRP>No</GSTCALCSLABONMRP>
      <MODIFYMRPRATE>No</MODIFYMRPRATE>
      <ALTERID> </ALTERID>
      <DENOMINATOR> 1</DENOMINATOR>
      <RATEOFVAT>0</RATEOFVAT>
      <VATBASENO> 1</VATBASENO>
      <VATTRAILNO> 1</VATTRAILNO>
      <VATACTUALRATIO> 1</VATACTUALRATIO>
      <OPENINGBALANCE>' . $rowAllStocks['st_gs_weight'] . '</OPENINGBALANCE>
      <OPENINGVALUE>' . $rowAllStocks['st_final_valuation'] . '</OPENINGVALUE>
      <OPENINGRATE>' . $rowAllStocks['st_metal_rate'] . '</OPENINGRATE>
      <SERVICETAXDETAILS.LIST>      </SERVICETAXDETAILS.LIST>
      <VATDETAILS.LIST>      </VATDETAILS.LIST>
      <SALESTAXCESSDETAILS.LIST>      </SALESTAXCESSDETAILS.LIST>
      <GSTDETAILS.LIST>      </GSTDETAILS.LIST>
      <LANGUAGENAME.LIST>
       <NAME.LIST TYPE="String">
        <NAME>' . $rowAllStocks['st_item_name'] . '</NAME>
        <NAME>' . $rowAllStocks['st_item_name'] . '</NAME>
       </NAME.LIST>
       <LANGUAGEID></LANGUAGEID>
      </LANGUAGENAME.LIST>
      <SCHVIDETAILS.LIST>      </SCHVIDETAILS.LIST>
      <EXCISETARIFFDETAILS.LIST>      </EXCISETARIFFDETAILS.LIST>
      <TCSCATEGORYDETAILS.LIST>      </TCSCATEGORYDETAILS.LIST>
      <TDSCATEGORYDETAILS.LIST>      </TDSCATEGORYDETAILS.LIST>
      <EXCLUDEDTAXATIONS.LIST>      </EXCLUDEDTAXATIONS.LIST>
      <OLDAUDITENTRIES.LIST>      </OLDAUDITENTRIES.LIST>
      <ACCOUNTAUDITENTRIES.LIST>      </ACCOUNTAUDITENTRIES.LIST>
      <AUDITENTRIES.LIST>      </AUDITENTRIES.LIST>
      <MRPDETAILS.LIST>      </MRPDETAILS.LIST>
      <VATCLASSIFICATIONDETAILS.LIST>      </VATCLASSIFICATIONDETAILS.LIST>
      <COMPONENTLIST.LIST>      </COMPONENTLIST.LIST>
      <ADDITIONALLEDGERS.LIST>      </ADDITIONALLEDGERS.LIST>
      <SALESLIST.LIST>      </SALESLIST.LIST>
      <PURCHASELIST.LIST>      </PURCHASELIST.LIST>
      <FULLPRICELIST.LIST>      </FULLPRICELIST.LIST>
      <BATCHALLOCATIONS.LIST>
       <GODOWNNAME>Main Location</GODOWNNAME>
       <BATCHNAME>Primary Batch</BATCHNAME>
       <OPENINGBALANCE> ' . $rowAllStocks['st_gs_weight'] . '</OPENINGBALANCE>
       <OPENINGVALUE>' . $rowAllStocks['st_final_valuation'] . '</OPENINGVALUE>
       <OPENINGRATE>' . $rowAllStocks['st_metal_rate'] . '</OPENINGRATE>
      </BATCHALLOCATIONS.LIST>
      <TRADEREXCISEDUTIES.LIST>      </TRADEREXCISEDUTIES.LIST>
      <STANDARDCOSTLIST.LIST>      </STANDARDCOSTLIST.LIST>
      <STANDARDPRICELIST.LIST>      </STANDARDPRICELIST.LIST>
      <EXCISEITEMGODOWN.LIST>      </EXCISEITEMGODOWN.LIST>
      <MULTICOMPONENTLIST.LIST>      </MULTICOMPONENTLIST.LIST>
      <LBTDETAILS.LIST>      </LBTDETAILS.LIST>
      <PRICELEVELLIST.LIST>      </PRICELEVELLIST.LIST>
      <GSTCLASSFNIGSTRATES.LIST>      </GSTCLASSFNIGSTRATES.LIST>
      <EXTARIFFDUTYHEADDETAILS.LIST>      </EXTARIFFDUTYHEADDETAILS.LIST>
      <TEMPGSTITEMSLABRATES.LIST>      </TEMPGSTITEMSLABRATES.LIST>
     </STOCKITEM>
    </TALLYMESSAGE>';
}
//
//
$strTallyXMLStock .='</REQUESTDATA>
  </IMPORTDATA>
 </BODY>
</ENVELOPE>';
//
//
$readWritefile = fopen("StockItems.xml", "w");
fwrite($readWritefile, "\n" . $strTallyXMLStock);
fclose($readWritefile);
//
?>